<form id="payment-form" method="post" action="{% url 'payments:create_checkout_session' %}">
    {% csrf_token %}
    <label>Montant :</label>
    <input type="number" name="amount" required>
    <button type="submit">Payer avec Stripe</button>
</form>
<script src="https://js.stripe.com/v3/"></script>
<script>
document.getElementById('payment-form').onsubmit = async function(e) {
    e.preventDefault();
    const form = e.target;
    const data = new FormData(form);
    const response = await fetch(form.action, {
        method: "POST",
        headers: {"X-CSRFToken": data.get("csrfmiddlewaretoken")},
        body: data
    });
    const result = await response.json();
    if (result.url) {
        window.location.href = result.url;
    }
};
</script>